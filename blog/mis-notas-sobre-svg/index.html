<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mis notas sobre SVG &#8211; Mouseover animate</title>
    <meta name="description" content="Un blog sobre SVG · CSS3 · HTML5">
    <meta name="generator" content="Jekyll v3.5.2">
    <link rel="stylesheet" href="/blog/css/styles.css">
    <link rel="canonical" href="http://jorgeatgu.com/blog/mis-notas-sobre-svg/">
</head>


<body>
    <section class="container-boira">
        <header class="header">
    <nav class="header-nav  post-contenido va-m">
        <ul class="menu-principal va-m">
            <li class="menu-principal-li va-m">
                <a class="va-m" href="http://jorgeatgu.com/index">Web</a>
            </li>
            <li class="menu-principal-li va-m">
                <a class="va-m" href="http://jorgeatgu.com/blog">Blog</a>
            </li>
            <li class="menu-principal-li va-m">
                <a class="va-m" href="/blog/archivo/">Categorias</a>
            </li>
            <li class="menu-principal-li va-m">
                <a class="va-m" href="http://feedpress.me/scalable">RSS</a>
            </li>
        </ul>
    </nav>
</header>


        <article>
                <main>
      <article class="categoria-titulo">
  	    <h1>Mis notas sobre SVG &#8211; Mouseover animate</h1>
          <p class="articulo-fecha">
          <time datetime="2013-06-26 00:00:00 +0200">
              El
              26 de

                junio

                de
                2013
            </time>
        </p>
  	    <span class="archivado">Archivado en:

  	    <a class="archivado-texto" href="/blog/archivo/#diseño-gráfico">Diseño Gráfico</a>

  	    <a class="archivado-texto" href="/blog/archivo/#diseño-web">Diseño Web</a>

  	    <a class="archivado-texto" href="/blog/archivo/#svg">SVG</a>

          </span>
  	    <!-- Categorías:  -->

      </article>

      <article class="post-contenido">
  	    <p>Empiezo una nueva serie de entradas donde iré relatando los problemas que voy encontrando mientras utilizo <strong>SVG</strong>, y las soluciones a estos problemas. Lo llamare solución por llamarlo de alguna manera, ya que la solución a algunos problemas es directamente no utilizar ciertas cosas, y es que como viene siendo costumbre en este mundo nada funciona de la misma manera si lo vemos en Chrome, Safari, Firefox, Opera o IE.</p>

<!--more-->

<h2 id="mouseover-en-animate"><strong>Mouseover en animate</strong></h2>

<p>En el proceso de rediseño de mi web(si, estoy trabajando en una nueva versión) me decidí a incluir una animación en <strong>SVG</strong> que ocupara una buena parte de la cabecera, la idea era y es no tener que recurrir a <strong>JavaScript</strong> y conseguir todos los efectos con <strong>SVG</strong>, y para que la animación funcione poner todas y cada una de las animaciones en el <strong>HTML</strong>.</p>

<p>La parte principal de la animación consta de 288 polígonos a través de la etiqueta <code>polygon</code>, cada uno de ellos con sus respectivas animaciones a través de la etiqueta <code>animate</code>, cuando conseguí implementar todas las ideas que tenía para la animación me di cuenta de que aquello se me había ido completamente de las manos, la animación ocupaba mas o menos el 90% del HTML con un total de 1700 líneas, lo cual es una barbaridad y hace que el tamaño de un simple HTML alcance un peso de 158KB, así que me puse a buscar alguna solución para aquellas animaciones que eran iguales y se repetían continuamente en cada uno de los polígonos.</p>

<p>Si en lugar de tener un <code>animate </code>tenemos un <code>linearGradient </code>o un <code>filter </code>tenemos la etiqueta <code>defs</code> para almacenar los efectos, simplemente le colocamos un <code>id </code>y luego lo invocamos a través de la etiqueta <code>filter</code> o con el atributo <code>url</code>, para hacer lo mismo pero con las animaciones ya sea <code>animate </code>o <code>animateTransform</code>(no pongo <code>animateColor </code>ya que se ha desestimado para SVG 2) no disponemos de la etiqueta <code>defs </code>para almacenar las animaciones.</p>

<p>Como había dicho anteriormente tengo 288 polígonos, y muchos de ellos reciben la misma animación, asi que vamos a intentar ahorrar código. Lo primero es declarar al principio un <code>polygon </code>y dentro de las etiquetas cada una de nuestras animaciones a través de la etiqueta <code>animate</code>, luego lo invocamos con la etiqueta <code>use</code> y obtendremos un polygon con la mismas medidas y con todas las animaciones que tengamos declaradas, para mover de posicion el polygon nos bastara con utilizar las coordenadas <code>x </code>e <code>y</code> dentro de la etiqueta <code>use</code>, parece fácil ¿no? pues deberemos olvidarnos de esto si a nuestra animación tiene la orden de comenzar con <code>begin="mouseover"</code>, y es que los navegadores Chrome y Opera interpretan que estas declarando la animación sobre todos y cada uno de los polígonos, así que aunque tengamos declarados 288 <code>use </code>si me posiciono en el número 1 se va a activar inmediatamente la animación en los 287 restantes y yo lo que quiero es que la animación de cada <code>polygon </code>sea individual e independiente del resto. En cambio si probamos en Firefox si que se consigue el efecto deseado, es decir cada polygon es tratado de manera individual y solo se activaran las animaciones si nos posicionamos sobre uno de ellos. En Safari ni tan siquiera veremos los polígonos. Así que llegados a este punto si queremos conservar la animación deberemos declararla dentro de cada una de las etiquetas <code>use </code>o si optamos por declarar los <code>polygon </code>por separado pues dentro de su etiqueta correspondiente.</p>

<p>Aquí dejo el código por si alguien encuentra una solución, quizás este haciendo algo mal y si que se puede hacer : D!</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="lineno"> 1 </span><span class="p">&lt;</span><span class="nt">svg</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;svgfondo&quot;</span> <span class="na">version</span><span class="o">=</span><span class="s">&quot;1.1&quot;</span>
<span class="lineno"> 2 </span>      <span class="na">xmlns</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span>
<span class="lineno"> 3 </span>      <span class="na">xmlns:xlink</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span>
<span class="lineno"> 4 </span>      <span class="na">x</span><span class="o">=</span><span class="s">&quot;0px&quot;</span> <span class="na">y</span><span class="o">=</span><span class="s">&quot;0px&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;100%&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;100%&quot;</span>
<span class="lineno"> 5 </span>      <span class="na">viewBox</span><span class="o">=</span><span class="s">&quot;0 0 2000 800&quot;</span>
<span class="lineno"> 6 </span>      <span class="na">enable-background</span><span class="o">=</span><span class="s">&quot;new 0 0 2000 800&quot;</span>
<span class="lineno"> 7 </span>      <span class="na">xml:space</span><span class="o">=</span><span class="s">&quot;preserve&quot;</span><span class="p">&gt;</span>
<span class="lineno"> 8 </span>
<span class="lineno"> 9 </span>        <span class="p">&lt;</span><span class="nt">polygon</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;animacion&quot;</span>
<span class="lineno">10 </span>          <span class="na">fill</span><span class="o">=</span><span class="s">&quot;#000&quot;</span> <span class="na">points</span><span class="o">=</span><span class="s">&quot;948.742,46.109 923.149,90.439 897.556,46.109&quot;</span><span class="p">&gt;</span>
<span class="lineno">11 </span>          <span class="p">&lt;</span><span class="nt">animate</span> <span class="na">attributeName</span><span class="o">=</span><span class="s">&quot;fill&quot;</span> <span class="na">dur</span><span class="o">=</span><span class="s">&quot;8s&quot;</span>
<span class="lineno">12 </span>          <span class="na">values</span><span class="o">=</span><span class="s">&quot;#121;#EEBE0F&quot;</span> <span class="na">repeatCount</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
<span class="lineno">13 </span>          <span class="na">begin</span><span class="o">=</span><span class="s">&quot;4s&quot;</span> <span class="na">fill</span><span class="o">=</span><span class="s">&quot;remove&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">14 </span>          <span class="p">&lt;</span><span class="nt">animate</span> <span class="na">attributeName</span><span class="o">=</span><span class="s">&quot;fill&quot;</span> <span class="na">dur</span><span class="o">=</span><span class="s">&quot;5s&quot;</span>
<span class="lineno">15 </span>          <span class="na">values</span><span class="o">=</span><span class="s">&quot;#056158&quot;</span> <span class="na">repeatCount</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
<span class="lineno">16 </span>          <span class="na">begin</span><span class="o">=</span><span class="s">&quot;mouseover&quot;</span>  <span class="p">/&gt;</span>
<span class="lineno">17 </span>          <span class="p">&lt;</span><span class="nt">animateTransform</span>  <span class="na">attributeName</span><span class="o">=</span><span class="s">&quot;transform&quot;</span>
<span class="lineno">18 </span>          <span class="na">type</span><span class="o">=</span><span class="s">&quot;rotate&quot;</span> <span class="na">from</span><span class="o">=</span><span class="s">&quot;0 32 32&quot;</span> <span class="na">to</span><span class="o">=</span><span class="s">&quot;-360 32 32&quot;</span>
<span class="lineno">19 </span>          <span class="na">dur</span><span class="o">=</span><span class="s">&quot;15s&quot;</span> <span class="na">repeatDur</span><span class="o">=</span><span class="s">&quot;5&quot;</span> <span class="na">begin</span><span class="o">=</span><span class="s">&quot;mouseover&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">20 </span>        <span class="p">&lt;/</span><span class="nt">polygon</span><span class="p">&gt;</span>
<span class="lineno">21 </span>
<span class="lineno">22 </span>        <span class="p">&lt;</span><span class="nt">g</span><span class="p">&gt;</span>
<span class="lineno">23 </span>          <span class="p">&lt;</span><span class="nt">use</span> <span class="na">xlink:href</span><span class="o">=</span><span class="s">&quot;#animacion&quot;</span> <span class="na">x</span><span class="o">=</span><span class="s">&quot;100&quot;</span> <span class="na">y</span><span class="o">=</span><span class="s">&quot;60&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">24 </span>        <span class="p">&lt;/</span><span class="nt">g</span><span class="p">&gt;</span>
<span class="lineno">25 </span>          <span class="p">&lt;</span><span class="nt">use</span> <span class="na">xlink:href</span><span class="o">=</span><span class="s">&quot;#animacion&quot;</span> <span class="na">x</span><span class="o">=</span><span class="s">&quot;110&quot;</span> <span class="na">y</span><span class="o">=</span><span class="s">&quot;105&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">26 </span>          <span class="p">&lt;</span><span class="nt">use</span> <span class="na">xlink:href</span><span class="o">=</span><span class="s">&quot;#animacion&quot;</span> <span class="na">x</span><span class="o">=</span><span class="s">&quot;150&quot;</span> <span class="na">y</span><span class="o">=</span><span class="s">&quot;105&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">27 </span>          <span class="p">&lt;</span><span class="nt">use</span> <span class="na">xlink:href</span><span class="o">=</span><span class="s">&quot;#animacion&quot;</span> <span class="na">x</span><span class="o">=</span><span class="s">&quot;200&quot;</span> <span class="na">y</span><span class="o">=</span><span class="s">&quot;105&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">28 </span>          <span class="p">&lt;</span><span class="nt">use</span> <span class="na">xlink:href</span><span class="o">=</span><span class="s">&quot;#animacion&quot;</span> <span class="na">x</span><span class="o">=</span><span class="s">&quot;250&quot;</span> <span class="na">y</span><span class="o">=</span><span class="s">&quot;105&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">29 </span>          <span class="p">&lt;</span><span class="nt">use</span> <span class="na">xlink:href</span><span class="o">=</span><span class="s">&quot;#animacion&quot;</span> <span class="na">x</span><span class="o">=</span><span class="s">&quot;300&quot;</span> <span class="na">y</span><span class="o">=</span><span class="s">&quot;105&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">30 </span>
<span class="lineno">31 </span>          <span class="p">&lt;</span><span class="nt">polygon</span> <span class="na">fill</span><span class="o">=</span><span class="s">&quot;#000&quot;</span>
<span class="lineno">32 </span>          <span class="na">points</span><span class="o">=</span><span class="s">&quot;974.337,90.439 948.742,134.77 923.149,90.439  &quot;</span><span class="p">&gt;</span>
<span class="lineno">33 </span>            <span class="p">&lt;</span><span class="nt">animate</span> <span class="na">attributeName</span><span class="o">=</span><span class="s">&quot;fill&quot;</span>  <span class="na">dur</span><span class="o">=</span><span class="s">&quot;8s&quot;</span>
<span class="lineno">34 </span>            <span class="na">values</span><span class="o">=</span><span class="s">&quot;#121;#EEBE0F&quot;</span> <span class="na">repeatCount</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
<span class="lineno">35 </span>            <span class="na">begin</span><span class="o">=</span><span class="s">&quot;4s&quot;</span> <span class="na">fill</span><span class="o">=</span><span class="s">&quot;freeze&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">36 </span>            <span class="p">&lt;</span><span class="nt">animate</span> <span class="na">attributeName</span><span class="o">=</span><span class="s">&quot;fill&quot;</span> <span class="na">dur</span><span class="o">=</span><span class="s">&quot;5s&quot;</span>
<span class="lineno">37 </span>            <span class="na">values</span><span class="o">=</span><span class="s">&quot;#056158&quot;</span> <span class="na">repeatCount</span><span class="o">=</span><span class="s">&quot;1&quot;</span> <span class="na">begin</span><span class="o">=</span><span class="s">&quot;mouseover&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">38 </span>            <span class="p">&lt;</span><span class="nt">animateTransform</span> <span class="na">attributeName</span><span class="o">=</span><span class="s">&quot;transform&quot;</span>
<span class="lineno">39 </span>            <span class="na">type</span><span class="o">=</span><span class="s">&quot;rotate&quot;</span> <span class="na">from</span><span class="o">=</span><span class="s">&quot;0 32 32&quot;</span> <span class="na">to</span><span class="o">=</span><span class="s">&quot;-360 32 32&quot;</span>
<span class="lineno">40 </span>            <span class="na">dur</span><span class="o">=</span><span class="s">&quot;15s&quot;</span> <span class="na">repeatDur</span><span class="o">=</span><span class="s">&quot;5&quot;</span> <span class="na">begin</span><span class="o">=</span><span class="s">&quot;mouseover&quot;</span> <span class="p">/&gt;</span>
<span class="lineno">41 </span>          <span class="p">&lt;/</span><span class="nt">polygon</span><span class="p">&gt;</span>
<span class="lineno">42 </span>        <span class="p">&lt;/</span><span class="nt">svg</span><span class="p">&gt;</span></code></pre></figure>

<p>Aquí un vídeo donde se ve lo que hace cada navegador, el orden de aparición es: Opera, Firefox, Chrome y Safari.</p>

<iframe class="vine-embed" src="https://vine.co/v/huhihlUxgIA/embed/simple" width="480" height="480" frameborder="0"></iframe>
<script async="" src="//platform.vine.co/static/scripts/embed.js" charset="utf-8"></script>

<p>Parece ser que es un error de los navegadores que llevan webkit, aquí una entrada de stackoverflow hablando sobre los animate en Chrome.</p>

<p><a href="http://stackoverflow.com/questions/13530894/chrome-svg-animate-tag" target="_blank">http://stackoverflow.com/questions/13530894/chrome-svg-animate-tag</a></p>

<p>Y el post de bugs.webkit</p>

<p><a href="https://bugs.webkit.org/show_bug.cgi?id=21371" target="_blank">https://bugs.webkit.org/show_bug.cgi?id=21371</a></p>

<p><a href="http://www.w3.org/Graphics/SVG/Test/20061213/svggen/animate-elem-34-t.svg" target="_blank">Y de regalo otro SVG(creado en 2003) que tan solo funciona en Firefox. </a></p>


        <a href="https://leanpub.com/scalable/" class="scalable-leanpub">SCALABLE, un libro sobre SVG<span>A lo largo de 15 capítulos, 120 páginas y más de 70 ejemplos vamos a ver todo lo que podemos hacer con SVG.</span>
        <span>Tu pones el precio, disponible desde 0$ para descargar desde LeanPub(PDF, ePUB y MOBI).</span>
        </a>
      </article>
    </main>

    <article class="paginacion post-contenido">

            <a class="btn-posterior" href="/blog/libros-sobre-svg/">Artículo posterior</a>


            <a class="btn-anterior" href="/blog/inspiracion-diseno-grafico-xi/">Artículo anterior</a>

    </article>


    <article id="disqus_thread"></article>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jorgeatgu'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
       })();
   </script>


        </article>
          <footer class="panel-poison post-contenido">
    <h3 class="panel-poison-left"><a class="footer-l" href="https://github.com/jorgeatgu/boira">Boira</a> por <a class="footer-l" href="http://jorgeatgu.com">Jorge Aznar</a></h3>
    <h3 class="panel-poison-right"><a href="http://github.com/jorgeatgu" class="footer-l">GitHub</a> <strong>·</strong> <a href="https://jorgeatgu.carto.com/me" class="footer-l">Carto</a> <strong>·</strong> <a href="http://twitter.com/jorgeatgu" class="footer-l">Twitter</a> <strong>·</strong> <a href="http://codepen.io/jorgeatgu" class="footer-l">CodePen</a></h3>
  </footer>


    </section>
</body>

</html>
